<!DOCTYPE html>
<head>
    <title>Bug Tracker</title>

    <link rel="stylesheet" type="text/css" href="https://datatables.net/media/css/site-examples.css?_=0602f7ec58abe00302963423bf7a8d5a">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.24/css/dataTables.bootstrap4.min.css" />

    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/dataTables.bootstrap4.min.js"></script>
    <script>

        $('document').ready(() => {

            $('#myTable').DataTable({
                "language": {
                    "emptyTable": "No bugs currently being tracked"
                }
            });

        });
    </script>
    <style>

        #main-container {
          display: flex;
          flex-direction: column;
          justify-content: center;
        }

        #main-row {
          display: flex;
          flex-direction: column;
        }

        #main-row h5 {
          text-align: center;
          color: green;
          height: 24px;
        }

        .row .col {
            margin-top: 5px; margin-bottom: 5px;
        }

        .table input {
            border: 0;
        }

        .form-btn {
            display: flex;
            flex-direction: column;
            margin-top: 60px;
        }

        table.dataTable tbody td {
            vertical-align: middle;
        }

    </style>
</head>
<body>
    <nav class="navbar navbar-expand-md navbar-light bg-white shadow-sm">
        <div class="container">
            <a class="navbar-brand" href="/" style="display: flex; align-items: center;">
            <img src="https://getbootstrap.com/docs/4.0/assets/brand/bootstrap-solid.svg" 
            width="30" height="30" class="d-inline-block align-top" alt="" style="margin-right: 3px;">
            <div>ug Tracker</div>
            </a>

            <div id="navbarSupportedContent" class="collapse navbar-collapse">
                <ul class="navbar-nav mr-auto"></ul> 
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item"><a href="/admin" class="nav-link">
                        Admin <span id="cartBadge" class="badge badge-success"></span></a>
                    </li> 
                </ul>
            </div>
        </div>
    </nav>

    <div id="main-container" class="container">

        <div class="col-12 justify-content-center p-3">


            <!-- Table -->
            <table id="myTable" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <th>Title</th>
                    <th>Description</th>
                    <th>Reported</th>
                    <th>Assignee</th>
                    <th>Resolved</th>
                    <th>Days Left</th>
                </thead>
                <tbody>
                    <% bugs.forEach((bug) => { %>
                    
                    <tr <% if(bug.daysLeft <= 0) { %> style="background-color: lightyellow" <% } %> >
                        <td><%= bug.title %></td>
                        <td><%= bug.description %></td>
                        <td><%= bug.reported %></td>
                        <td><%= bug.assignee %></td>
                        <td><% if(bug.resolved) { %> <%= "Yes" %>  
                            <% } else { %> 
                            <form method="POST">
                                <button formaction="/resolve/<%= bug._id %>" class="btn btn-primary" 
                                    type="submit" style="font-size: 14px">Confirm</button>
                            </form>
                            <% } %> 
                        </td>
                        <td><%= bug.daysLeft %> </td>
                    </tr>
                    
                    <% }); %> 
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>